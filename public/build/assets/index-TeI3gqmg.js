import{r as u,j as p,B as A,a4 as k,z as v}from"./app-DG_quuA_.js";import{G as I}from"./Group-CeJplS76.js";import{B as L}from"./Button-CtqclE1W.js";import{u as N}from"./events-CBmrCxgV.js";import{c as K,a as Q,m as V,o as W,b as X,d as Y,e as $,f as oo}from"./events-CBmrCxgV.js";import{M as R}from"./Modal-BkjOtdbC.js";import"./FocusTrap-CbdYIe9M.js";import"./Paper-DYlBl8P3.js";const j=u.createContext(null);j.displayName="@mantine/modals/ModalsContext";function B(){const o=u.useContext(j);if(!o)throw new Error("[@mantine/modals] useModals hook was called outside of context, wrap your app with ModalsProvider component");return o}function D({id:o,cancelProps:t,confirmProps:s,labels:a={cancel:"",confirm:""},closeOnConfirm:l=!0,closeOnCancel:n=!0,groupProps:i,onCancel:r,onConfirm:C,children:f}){const{cancel:x,confirm:m}=a,M=B(),y=h=>{typeof(t==null?void 0:t.onClick)=="function"&&(t==null||t.onClick(h)),typeof r=="function"&&r(),n&&M.closeModal(o)},E=h=>{typeof(s==null?void 0:s.onClick)=="function"&&(s==null||s.onClick(h)),typeof C=="function"&&C(),l&&M.closeModal(o)};return p.jsxs(p.Fragment,{children:[f&&p.jsx(A,{mb:"md",children:f}),p.jsxs(I,{mt:f?0:"md",justify:"flex-end",...i,children:[p.jsx(L,{variant:"default",...t,onClick:y,children:(t==null?void 0:t.children)||x}),p.jsx(L,{...s,onClick:E,children:(s==null?void 0:s.children)||m})]})]})}function O(o,t){var s,a,l,n;t&&o.type==="confirm"&&((a=(s=o.props).onCancel)==null||a.call(s)),(n=(l=o.props).onClose)==null||n.call(l)}function S(o,t){var s;switch(t.type){case"OPEN":return{current:t.modal,modals:[...o.modals,t.modal]};case"CLOSE":{const a=o.modals.find(n=>n.id===t.modalId);if(!a)return o;O(a,t.canceled);const l=o.modals.filter(n=>n.id!==t.modalId);return{current:l[l.length-1]||o.current,modals:l}}case"CLOSE_ALL":return o.modals.length?(o.modals.concat().reverse().forEach(a=>{O(a,t.canceled)}),{current:o.current,modals:[]}):o;case"UPDATE":{const{modalId:a,newProps:l}=t,n=o.modals.map(r=>r.id!==a?r:r.type==="content"||r.type==="confirm"?{...r,props:{...r.props,...l}}:r.type==="context"?{...r,props:{...r.props,...l,innerProps:{...r.props.innerProps,...l.innerProps}}}:r),i=((s=o.current)==null?void 0:s.id)===a&&n.find(r=>r.id===a)||o.current;return{...o,modals:n,current:i}}default:return o}}function P(o){if(!o)return{confirmProps:{},modalProps:{}};const{id:t,children:s,onCancel:a,onConfirm:l,closeOnConfirm:n,closeOnCancel:i,cancelProps:r,confirmProps:C,groupProps:f,labels:x,...m}=o;return{confirmProps:{id:t,children:s,onCancel:a,onConfirm:l,closeOnConfirm:n,closeOnCancel:i,cancelProps:r,confirmProps:C,groupProps:f,labels:x},modalProps:{id:t,...m}}}function q({children:o,modalProps:t,labels:s,modals:a}){const[l,n]=u.useReducer(S,{modals:[],current:null}),i=u.useRef(l);i.current=l;const r=u.useCallback(e=>{n({type:"CLOSE_ALL",canceled:e})},[i,n]),C=u.useCallback(({modalId:e,...d})=>{const c=e||k();return n({type:"OPEN",modal:{id:c,type:"content",props:d}}),c},[n]),f=u.useCallback(({modalId:e,...d})=>{const c=e||k();return n({type:"OPEN",modal:{id:c,type:"confirm",props:d}}),c},[n]),x=u.useCallback((e,{modalId:d,...c})=>{const b=d||k();return n({type:"OPEN",modal:{id:b,type:"context",props:c,ctx:e}}),b},[n]),m=u.useCallback((e,d)=>{n({type:"CLOSE",modalId:e,canceled:d})},[i,n]),M=u.useCallback(({modalId:e,...d})=>{n({type:"UPDATE",modalId:e,newProps:d})},[n]),y=u.useCallback(({modalId:e,...d})=>{n({type:"UPDATE",modalId:e,newProps:d})},[n]);N({openModal:C,openConfirmModal:f,openContextModal:({modal:e,...d})=>x(e,d),closeModal:m,closeContextModal:m,closeAllModals:r,updateModal:M,updateContextModal:y});const E={modalProps:t||{},modals:l.modals,openModal:C,openConfirmModal:f,openContextModal:x,closeModal:m,closeContextModal:m,closeAll:r,updateModal:M,updateContextModal:y},h=()=>{const e=i.current.current;switch(e==null?void 0:e.type){case"context":{const{innerProps:d,...c}=e.props,b=a[e.ctx];return{modalProps:c,content:p.jsx(b,{innerProps:d,context:E,id:e.id})}}case"confirm":{const{modalProps:d,confirmProps:c}=P(e.props);return{modalProps:d,content:p.jsx(D,{...c,id:e.id,labels:e.props.labels||s})}}case"content":{const{children:d,...c}=e.props;return{modalProps:c,content:d}}default:return{modalProps:{},content:null}}},{modalProps:g,content:w}=h();return p.jsxs(j.Provider,{value:E,children:[p.jsx(R,{zIndex:v("modal")+1,...t,...g,opened:l.modals.length>0,onClose:()=>{var e;return m((e=l.current)==null?void 0:e.id)},children:w}),o]})}export{q as ModalsProvider,K as closeAllModals,Q as closeModal,V as modals,W as openConfirmModal,X as openContextModal,Y as openModal,$ as updateContextModal,oo as updateModal,B as useModals};
