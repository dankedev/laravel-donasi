import{r as u,j as p,B as A,a6 as k,z as v}from"./app-CGQQ-ZlW.js";import{G as I}from"./Group-CsOyVewc.js";import{B as L}from"./Button-MZvmU7_O.js";import{u as N}from"./events-BsPT7I9E.js";import{c as W,a as X,m as Y,o as $,b as oo,d as eo,e as to,f as no}from"./events-BsPT7I9E.js";import{M as R}from"./Modal-DY6RgkFE.js";import"./create-safe-context-50zDxaJY.js";import"./FocusTrap-CDHUeOCU.js";import"./is-element-qvA2NJ6b.js";import"./Paper-CIYb7ukR.js";import"./Overlay-Cnr7V7lH.js";const j=u.createContext(null);j.displayName="@mantine/modals/ModalsContext";function B(){const o=u.useContext(j);if(!o)throw new Error("[@mantine/modals] useModals hook was called outside of context, wrap your app with ModalsProvider component");return o}function D({id:o,cancelProps:n,confirmProps:s,labels:a={cancel:"",confirm:""},closeOnConfirm:l=!0,closeOnCancel:t=!0,groupProps:i,onCancel:r,onConfirm:C,children:f}){const{cancel:x,confirm:m}=a,M=B(),y=h=>{typeof(n==null?void 0:n.onClick)=="function"&&(n==null||n.onClick(h)),typeof r=="function"&&r(),t&&M.closeModal(o)},E=h=>{typeof(s==null?void 0:s.onClick)=="function"&&(s==null||s.onClick(h)),typeof C=="function"&&C(),l&&M.closeModal(o)};return p.jsxs(p.Fragment,{children:[f&&p.jsx(A,{mb:"md",children:f}),p.jsxs(I,{mt:f?0:"md",justify:"flex-end",...i,children:[p.jsx(L,{variant:"default",...n,onClick:y,children:(n==null?void 0:n.children)||x}),p.jsx(L,{...s,onClick:E,children:(s==null?void 0:s.children)||m})]})]})}function O(o,n){var s,a,l,t;n&&o.type==="confirm"&&((a=(s=o.props).onCancel)==null||a.call(s)),(t=(l=o.props).onClose)==null||t.call(l)}function S(o,n){var s;switch(n.type){case"OPEN":return{current:n.modal,modals:[...o.modals,n.modal]};case"CLOSE":{const a=o.modals.find(t=>t.id===n.modalId);if(!a)return o;O(a,n.canceled);const l=o.modals.filter(t=>t.id!==n.modalId);return{current:l[l.length-1]||o.current,modals:l}}case"CLOSE_ALL":return o.modals.length?(o.modals.concat().reverse().forEach(a=>{O(a,n.canceled)}),{current:o.current,modals:[]}):o;case"UPDATE":{const{modalId:a,newProps:l}=n,t=o.modals.map(r=>r.id!==a?r:r.type==="content"||r.type==="confirm"?{...r,props:{...r.props,...l}}:r.type==="context"?{...r,props:{...r.props,...l,innerProps:{...r.props.innerProps,...l.innerProps}}}:r),i=((s=o.current)==null?void 0:s.id)===a&&t.find(r=>r.id===a)||o.current;return{...o,modals:t,current:i}}default:return o}}function P(o){if(!o)return{confirmProps:{},modalProps:{}};const{id:n,children:s,onCancel:a,onConfirm:l,closeOnConfirm:t,closeOnCancel:i,cancelProps:r,confirmProps:C,groupProps:f,labels:x,...m}=o;return{confirmProps:{id:n,children:s,onCancel:a,onConfirm:l,closeOnConfirm:t,closeOnCancel:i,cancelProps:r,confirmProps:C,groupProps:f,labels:x},modalProps:{id:n,...m}}}function K({children:o,modalProps:n,labels:s,modals:a}){const[l,t]=u.useReducer(S,{modals:[],current:null}),i=u.useRef(l);i.current=l;const r=u.useCallback(e=>{t({type:"CLOSE_ALL",canceled:e})},[i,t]),C=u.useCallback(({modalId:e,...d})=>{const c=e||k();return t({type:"OPEN",modal:{id:c,type:"content",props:d}}),c},[t]),f=u.useCallback(({modalId:e,...d})=>{const c=e||k();return t({type:"OPEN",modal:{id:c,type:"confirm",props:d}}),c},[t]),x=u.useCallback((e,{modalId:d,...c})=>{const b=d||k();return t({type:"OPEN",modal:{id:b,type:"context",props:c,ctx:e}}),b},[t]),m=u.useCallback((e,d)=>{t({type:"CLOSE",modalId:e,canceled:d})},[i,t]),M=u.useCallback(({modalId:e,...d})=>{t({type:"UPDATE",modalId:e,newProps:d})},[t]),y=u.useCallback(({modalId:e,...d})=>{t({type:"UPDATE",modalId:e,newProps:d})},[t]);N({openModal:C,openConfirmModal:f,openContextModal:({modal:e,...d})=>x(e,d),closeModal:m,closeContextModal:m,closeAllModals:r,updateModal:M,updateContextModal:y});const E={modalProps:n||{},modals:l.modals,openModal:C,openConfirmModal:f,openContextModal:x,closeModal:m,closeContextModal:m,closeAll:r,updateModal:M,updateContextModal:y},h=()=>{const e=i.current.current;switch(e==null?void 0:e.type){case"context":{const{innerProps:d,...c}=e.props,b=a[e.ctx];return{modalProps:c,content:p.jsx(b,{innerProps:d,context:E,id:e.id})}}case"confirm":{const{modalProps:d,confirmProps:c}=P(e.props);return{modalProps:d,content:p.jsx(D,{...c,id:e.id,labels:e.props.labels||s})}}case"content":{const{children:d,...c}=e.props;return{modalProps:c,content:d}}default:return{modalProps:{},content:null}}},{modalProps:g,content:w}=h();return p.jsxs(j.Provider,{value:E,children:[p.jsx(R,{zIndex:v("modal")+1,...n,...g,opened:l.modals.length>0,onClose:()=>{var e;return m((e=l.current)==null?void 0:e.id)},children:w}),o]})}export{K as ModalsProvider,W as closeAllModals,X as closeModal,Y as modals,$ as openConfirmModal,oo as openContextModal,eo as openModal,to as updateContextModal,no as updateModal,B as useModals};
